# タスクリスト - eBay Store Monitor

## プロジェクト概要
eBayストアの出品リストを監視し、変化があった際に通知を送信するWebアプリケーションの開発

## 技術スタック
- Next.js 15 + TypeScript
- Tailwind CSS
- Prisma ORM
- NextAuth.js
- Resend (メール通知)
- Playwright + Stealth Plugin (クローリング)

---

## 1. プロジェクト基盤セットアップ

### 1.1 依存関係のインストール
- [ ] Prismaのセットアップ
- [ ] NextAuth.jsのセットアップ
- [ ] Tailwind CSSの設定
- [ ] Playwrightのセットアップ
- [ ] Resendのセットアップ

### 1.2 環境設定
- [ ] .envファイルの作成
- [ ] 環境変数の設定
- [ ] TypeScript設定の最適化

### 1.3 プロジェクト構造の設計
- [ ] ディレクトリ構造の作成
- [ ] 共通コンポーネントの設計
- [ ] ユーティリティ関数の整理

---

## 2. データベース設計・実装

### 2.1 Prismaスキーマの設計
- [ ] Userモデル（name, email, role）
- [ ] Storeモデル（eBayストア情報）
- [ ] Productモデル（出品商品情報）
- [ ] CrawlLogモデル（クローリング記録）
- [ ] Notificationモデル（通知履歴）
- [ ] CrawlStatusモデル（監視状態管理）

### 2.2 データベースマイグレーション
- [ ] 初期マイグレーションの作成
- [ ] シードデータの作成
- [ ] インデックスの最適化

---

## 3. 認証システム

### 3.1 ユーザー認証
- [ ] NextAuth.jsの設定
- [ ] ログイン・ログアウト機能
- [ ] ユーザー登録機能
- [ ] セッション管理

### 3.2 ロールベースアクセス制御
- [ ] admin/customerロールの実装
- [ ] 権限チェックミドルウェア
- [ ] 保護されたルートの実装

---

## 4. eBayストア監視システム（メイン機能）

### 4.1 クローリング基盤
- [ ] Playwright + Stealth Pluginの設定
- [ ] レート制限の実装
- [ ] エラーハンドリング
- [ ] リトライ機能

### 4.2 ストア監視ロジック
- [ ] ストア情報の取得
- [ ] 出品リストの解析
- [ ] 商品状態の比較
- [ ] 変化の検知ロジック

### 4.3 重複監視防止
- [ ] 監視状態のDB管理
- [ ] ロック機能の実装
- [ ] 複数サーバー対応

### 4.4 監視スクリプト
- [ ] `npm run ebay:store:observe`の実装
- [ ] バックグラウンド実行
- [ ] ログ記録機能

---

## 5. 通知システム

### 5.1 メール通知
- [ ] Resendの統合
- [ ] メールテンプレートの作成
- [ ] 通知条件の設定

### 5.2 LINE通知
- [ ] LINE Notify APIの統合
- [ ] 通知メッセージのフォーマット
- [ ] 通知設定の管理

### 5.3 通知管理
- [ ] 通知履歴の記録
- [ ] 通知設定の管理
- [ ] 通知の無効化機能

---

## 6. 管理画面（Google Spreadsheet風UI）

### 6.1 基本レイアウト
- [ ] グリッドレイアウトの実装
- [ ] ヘッダー・サイドバーの作成
- [ ] レスポンシブデザイン

### 6.2 データ表示機能
- [ ] 売れた商品の一覧表示
- [ ] フィルタリング機能
- [ ] ソート機能
- [ ] ページネーション

### 6.3 リアルタイム更新
- [ ] WebSocketまたはポーリングの実装
- [ ] データの自動更新
- [ ] 更新通知の表示

---

## 7. API開発

### 7.1 認証API
- [ ] ログインAPI
- [ ] ユーザー登録API
- [ ] セッション管理API

### 7.2 ストア管理API
- [ ] ストア一覧取得API
- [ ] ストア追加API
- [ ] ストア更新API
- [ ] ストア削除API

### 7.3 商品管理API
- [ ] 商品一覧取得API
- [ ] 商品詳細取得API
- [ ] 商品検索API

### 7.4 通知API
- [ ] 通知履歴取得API
- [ ] 通知設定更新API

---

## 8. テスト・品質保証

### 8.1 単体テスト
- [ ] ユーティリティ関数のテスト
- [ ] APIエンドポイントのテスト
- [ ] コンポーネントのテスト

### 8.2 統合テスト
- [ ] 認証フローのテスト
- [ ] クローリング機能のテスト
- [ ] 通知機能のテスト

### 8.3 E2Eテスト
- [ ] ユーザー登録フローのテスト
- [ ] 管理画面の操作テスト
- [ ] 通知受信のテスト

---

## 9. デプロイ・運用

### 9.1 本番環境セットアップ
- [ ] Vercelの設定
- [ ] データベースの本番環境設定
- [ ] 環境変数の設定

### 9.2 監視・ログ
- [ ] アプリケーションログの設定
- [ ] エラー監視の設定
- [ ] パフォーマンス監視

### 9.3 バックアップ・復旧
- [ ] データベースバックアップの設定
- [ ] 復旧手順の文書化

---

## 10. ドキュメント・保守

### 10.1 API仕様書
- [ ] OpenAPI仕様書の作成
- [ ] APIドキュメントの生成

### 10.2 運用マニュアル
- [ ] デプロイ手順書
- [ ] トラブルシューティングガイド
- [ ] 監視・メンテナンス手順

---

## 優先度

### 高優先度（MVP）
1. プロジェクト基盤セットアップ
2. データベース設計・実装
3. 認証システム
4. eBayストア監視システム（メイン機能）
5. 基本的な管理画面

### 中優先度
6. 通知システム
7. 高度な管理画面機能
8. テスト・品質保証

### 低優先度
9. デプロイ・運用
10. ドキュメント・保守

---

## 注意事項

- クローリング機能は規制を厳格に守る
- 複数サーバーでの重複監視を防ぐ
- エラーが発生した場合は即座に把握できるようにする
- Google Spreadsheet風のUIを目指す
- 堅牢な設計を心がける（特に監視システム）
